(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-260cbf6e"],{3703:function(t,e,r){"use strict";r.r(e);r("8e6e"),r("456d"),r("ac6a");var o=r("ade3"),n=r("2f62"),i=r("d055"),a=r.n(i),c=r("235a"),s=r("d3b5"),l=r("82c3"),d=r("46f9"),p=r("772e"),u=(r("bc3a"),r("118a")),h=r("ed3b");function f(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function b(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?f(Object(r),!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var v,g,w={props:{work:{type:Object,default:function(){}},handleClickEdit:{type:Function,default:function(){}},handleClickPreview:{type:Function,default:function(){}}},data:function(){return{text:"",qrcodeUrl:"",mypage:[],visible:!1}},methods:b(b({},Object(n["b"])("editor",["fetchWork"])),{},{timeFmt:function(t){var e=new Date(t),r="".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate());return r},genQRCodeUrl:function(t){var e=this,r="".concat(window.location.origin,"/works/preview/").concat(t.id);a.a.toDataURL(r,(function(t,r){t&&console.log(t),e.qrcodeUrl=r}))},getHtml:function(t){var e=this;c["a"].getEntry("works",t.id).then((function(t){t.pages.forEach((function(t){for(var r={elements:[]},o=0;o<t.elements.length;o++)r.elements.push(new p["a"](t.elements[o]));e.mypage.push(r)})),e.visible=!0}))},saveHtml:function(){var t=this,e=document.createElement("a");e.style.display="none",e.download="index.html",Object(u["a"])(document.getElementById("preview").innerHTML).then((function(r){var o=new Blob([r]);e.href=URL.createObjectURL(o),e.click(),t.close()}))},close:function(){this.visible=!1,this.mypage=[]}}),render:function(t){var e=this;return t("a-card",{attrs:{hoverable:!0}},[t(h["a"],{attrs:{title:"确定要下载为HTML？",visible:this.visible,okText:"下载",closable:!0},on:{ok:this.saveHtml,cancel:this.close}},[t("div",[this.mypage.map((function(e){return t(l["a"],{attrs:{id:"preview",elements:e.elements},style:{height:"100%",width:"100%"}})}))])]),t(d["a"],{slot:"cover",attrs:{qrcodeUrl:this.qrcodeUrl,coverImageUrl:this.work.cover_image_url}}),t("template",{class:"ant-card-actions",slot:"actions"},[t("a-tooltip",{attrs:{effect:"dark",placement:"bottom",title:this.$t("workCard.edit")}},[t("router-link",{attrs:{to:{name:"editor",params:{workId:this.work.id}},target:"_blank"}},[t("a-icon",{attrs:{type:"edit",title:this.$t("workCard.edit")}})])]),t("a-tooltip",{attrs:{effect:"dark",placement:"bottom",title:this.$t("workCard.preview")}},[t("a-icon",{attrs:{type:"eye",title:this.$t("workCard.preview")},on:{click:this.handleClickPreview}})]),t("a-tooltip",{attrs:{effect:"dark",placement:"bottom",title:"下载"}},[t("a-icon",{attrs:{type:"download"},on:{click:function(){return e.getHtml(e.work)}}})]),this.qrcodeUrl?t("a-icon",{attrs:{type:"close-circle"},on:{click:function(){e.qrcodeUrl=""}}}):t("a-icon",{attrs:{type:"qrcode"},on:{click:function(){return e.genQRCodeUrl(e.work)}}})]),t("a-card-meta",[t("div",{slot:"title",class:"ant-card-meta-title",style:"font-size: 14px;"},[this.work.title,"(",this.work.id,")"]),t("div",{slot:"description",style:"font-size: 12px;"},[t("div",[this.$t("workCard.description"),": ",this.work.description]),t("div",[this.$t("workCard.createTime"),": ",this.timeFmt(this.work.created_at)])])])])}},m={functional:!0,render:function(t,e){var r=e.props,o=e.parent;return t("a-card",{attrs:{hoverable:!0}},[t("div",{slot:"cover",class:"flex-center",style:"height: 405px;background: #f7f5f557;",on:{click:r.handleCreate}},[t("a-icon",{attrs:{type:"plus"}})]),t("template",{class:"ant-card-actions",slot:"actions"},[t("span",{on:{click:r.handleCreate}},[o.$t("workCard.createNewWork")])])])}},k={components:{ListItemCard:w,AddNewCard:m},data:function(){return{activeWork:null,previewVisible:!1}},computed:b(b({},Object(n["c"])("editor",["works"])),Object(n["c"])("loading",["fetchWorks_loading"])),methods:b(b({},Object(n["b"])("editor",["fetchWorks","createWork"])),{},{deleteWork:function(t){}}),render:function(t){var e=this;return t("div",{class:"works-wrapper"},[t("a-row",{attrs:{gutter:12}},[t("a-col",{attrs:{span:6},style:"margin-bottom: 10px;"},[t(m,{attrs:{handleCreate:this.createWork}})]),this.fetchWorks_loading?t("a-col",{attrs:{span:18},style:"margin-bottom: 10px;text-align: center;height: 355px;line-height: 355px;border-bottom: 1px solid #ebedf0;background: rgba(255, 255, 255, 0.5);"},[t("a-spin",{attrs:{tip:"作品列表获取中..."}})]):this.works.map((function(r){return t("a-col",{attrs:{span:6},key:r.id,style:"margin-bottom: 20px;"},[t(w,{attrs:{work:r,handleClickPreview:function(t){e.previewVisible=!0,e.activeWork=r}}})])}))]),t(s["a"],{attrs:{work:this.activeWork||{},visible:this.previewVisible,handleClose:function(){e.previewVisible=!1}}})])},created:function(){this.fetchWorks()}},y=k,O=r("2877"),j=Object(O["a"])(y,v,g,!1,null,null,null);e["default"]=j.exports},"3cce":function(t,e,r){var o=r("e13d");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var n=r("499e").default;n("50f828a5",o,!0,{sourceMap:!1,shadowMode:!1})},"46f9":function(t,e,r){"use strict";r("8e6e"),r("ac6a"),r("456d"),r("a481");var o=r("ade3"),n=r("d085"),i=r.n(n);r("3cce");function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e){return{position:"absolute",top:0,left:0,zIndex:0,height:"100%",width:"100%",backgroundSize:e?"contain":"cover",backgroundRepeat:"no-repeat",backgroundImage:"url(".concat(t,")")}}e["a"]={props:{qrcodeUrl:String,coverImageUrl:String},methods:{getCover:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.$createElement,o=70,n=c(c({},s(t,e)),{},{zIndex:1,width:"".concat(o,"%"),margin:"0 ".concat(50-o/2,"%")});return[r("div",{style:n})]},getCoverBg:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.$createElement,o=c(c({},s(t)),{},{filter:!e&&"blur(10px)"});return[r("div",{style:o})]}},render:function(t){var e=[this.getCover(i.a,!0)];if(this.qrcodeUrl)e=this.getCoverBg(this.qrcodeUrl,!0);else if(this.coverImageUrl){var r=this.coverImageUrl.replace("http://localhost:1337","");e=[this.getCover(r),this.getCoverBg(r)]}return t("div",{class:"card-cover-wrapper"},[e])}}},d085:function(t,e,r){t.exports=r.p+"img/lbp-picture-placeholder.aa9bb3d3.png"},e13d:function(t,e,r){e=t.exports=r("2350")(!1),e.push([t.i,".card-cover-wrapper{position:relative;height:300px;border:1px dashed #eee;color:#aaa;padding:4px}",""])}}]);